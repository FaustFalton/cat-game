@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

/* --- GENERAL --- */
body {
  margin: 0; overflow: hidden;
  user-select: none; background-color: #111;
  font-family: 'Press Start 2P', cursive;
  color: white;
}

.game-container {
  width: 100vw; height: 100vh;
  /* Đảm bảo bạn đã có ảnh bg_minecraft.png trong thư mục public/assets */
  background: #1a1a1a url('/assets/bg_minecraft.png') no-repeat center/cover;
  position: relative; background-position-y:-320px ;
}

/* --- UI FRAME & POPUP --- */
.minigame-overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0.85); z-index: 3000;
  display: flex; align-items: center; justify-content: center;
}

.pixel-panel {
  background-color: #3e2723; border: 4px solid #fff;
  box-shadow: 6px 6px 0 #000; padding: 20px; text-align: center;
  min-width: 500px; max-width: 90%; position: relative;
  image-rendering: pixelated;
}

/* --- BUTTONS --- */
button {
  font-family: 'Press Start 2P', cursive; cursor: pointer; 
  border: 3px solid #fff; color: rgb(255, 255, 255); padding: 10px; text-transform: uppercase; 
  font-size: 10px; margin: 5px; box-shadow: 3px 3px 0 #000; transition: 0.1s;
}
button:active { transform: translate(2px, 2px); box-shadow: 1px 1px 0 #000; }
button:disabled { filter: grayscale(1); cursor: not-allowed; }

.btn-action { background: #2e7d32; width: 100%; }
.btn-close { background: #c62828; position: absolute; top: 10px; right: 10px; z-index: 100; padding: 5px 10px;}
.btn-menu { background: #1565c0; min-width: 80px; font-size: 10px !important; color: white; }

/* --- TOP BAR --- */
.top-bar { 
  position: absolute; top: 0; left: 0; width: 100%; padding: 15px; 
  display: flex; justify-content: space-between; z-index: 2000; 
  pointer-events: none; box-sizing: border-box; 
}
.group-btn { pointer-events: auto; display: flex; gap: 10px; align-items: center; }
.stat-box { 
    background: #fbc02d; color: #3e2723; border: 2px solid white; 
    padding: 10px; font-size: 12px; font-weight: bold; 
    display: flex; align-items: center; gap: 5px;
}

/* --- GACHA SHOP UI --- */
.gacha-panel { width: 600px; display: flex; flex-direction: column; gap: 15px; }
.gacha-tabs { display: flex; gap: 5px; margin-bottom: -4px; padding-left: 10px; }
.tab-btn {
  background: #2d2d2d; color: #aaa; border: 4px solid #fff; border-bottom: none;
  padding: 10px 20px; cursor: pointer; font-family: inherit; font-size: 10px;
  position: relative; top: 4px; z-index: 1;
}
.tab-btn.active { background: #3e2723; color: white; top: 0; z-index: 10; padding-bottom: 14px; text-shadow: 0 0 5px gold; }

.gacha-banner {
  width: 100%; height: 120px; border: 4px solid #fff; box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  margin-bottom: 10px; position: relative; overflow: hidden;
}
.gacha-banner.cat { background: linear-gradient(135deg, #4a148c, #7b1fa2); }
.gacha-banner.acc { background: linear-gradient(135deg, #006064, #0097a7); }
.banner-title { font-size: 24px; color: gold; text-shadow: 2px 2px 0 #000; margin-bottom: 10px; }
.banner-info { font-size: 8px; color: #eee; background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 10px; }

.gacha-actions { display: flex; justify-content: center; gap: 20px; }
.btn-roll {
  background: #2e7d32; border: 4px solid #fff; color: white; padding: 15px; width: 140px; cursor: pointer;
  display: flex; flex-direction: column; align-items: center; gap: 5px; position: relative;
}
.btn-roll:hover { transform: scale(1.05); }
.btn-roll.premium { background: linear-gradient(to bottom, #f57f17, #fbc02d); border-color: gold; color: #3e2723; }
.guarantee-tag { font-size: 6px; background: #d32f2f; color: white; padding: 2px 4px; position: absolute; top: -10px; right: -5px; border: 1px solid white; }
.sui-top-up { margin-top: 20px; border-top: 2px dashed #aaa; padding-top: 15px; display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; }

/* Result Screen */
.result-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0; justify-items: center; }
.result-item { width: 60px; height: 70px; background: #fff; border: 3px solid #000; display: flex; flex-direction: column; align-items: center; justify-content: center; animation: popIn 0.3s ease-out; }
.result-item.SSR { border-color: gold; box-shadow: 0 0 10px gold; background: #fffde7; }
.result-item.SR { border-color: cyan; box-shadow: 0 0 5px cyan; }
.item-img { width: 32px; height: 32px; background-size: 128px auto; image-rendering: pixelated; background-position: 0 0; }
.item-name { font-size: 6px; margin-top: 5px; color: black; max-width: 100%; overflow: hidden; white-space: nowrap; }
@keyframes popIn { 0% { transform: scale(0); } 80% { transform: scale(1.1); } 100% { transform: scale(1); } }

/* --- COLLECTION BOOK UI --- */
.book-container {
  width: 700px; height: 450px; background: #5d4037; border: 4px double #8d6e63;
  display: flex; padding: 20px; color: #3e2723; box-sizing: border-box; position: relative;
}
.book-page { flex: 1; padding: 6px; display: flex; flex-direction: column; align-items: center; border: 1px solid #8d6e63; margin: 5px; background: #efebe9; }
.book-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px; max-height: 320px; overflow-y: auto; width: 100%; }
.book-item { width: 60px; height: 48px; border: 2px solid #8d6e63; background: rgba(255,255,255,0.4); display: flex; align-items: center; justify-content: center; }
.book-item.locked { background: #000; opacity: 0.5; filter: grayscale(1); }
.pixel-icon { width: 32px; height: 32px; background-repeat: no-repeat; background-position: 0 0; background-size: 128px auto; image-rendering: pixelated; transform: scale(1.5); background-position-y: -10px;}

/* --- DETAIL VIEW --- */
.cat-portrait { width: 120px; height: 110px; background-color: #fff; border: 4px solid #3e2723; margin: 20px; background-size: 400% 900%; background-position-x:0px; background-position-y: -15px; image-rendering: pixelated; margin-top: 10px;}
.rarity-badge { font-size: 20px; font-weight: bold; text-shadow: 1px 1px 0 #000; }
.info-page { align-items: flex-start; padding-left: 30px; justify-content: center; }
.info-row { display: flex; justify-content: space-between; width: 100%; margin-bottom: 15px; border-bottom: 2px dotted #8d6e63; padding-bottom: 5px; font-size: 10px; }
.action-row { display: flex; width: 100%; justify-content: space-between; align-items: center; margin-top: 20px; gap: 5px; }
.btn-nav { width: 40px; background: #8d6e63; border-color: #5d4037; }
.btn-equip { flex: 1; background: #307533; font-size: 10px; }
.btn-equip.unequip { background: #c62828; }
.btn-close-detail { margin-top: auto; align-self: center; background: #3e2723; border-color: #8d6e63; color: white; }

/* --- HOUSE GRID --- */
.house-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; max-height: 250px; overflow-y: auto; margin: 20px 0; background: #110d0d; padding:10px; border: 2px solid #555; }
.house-slot { border: 2px solid #666; padding: 5px; cursor: pointer; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 60px; }
.house-slot:hover { background: #444; }
.house-slot.active { border-color: #00e676; background: rgba(0, 230, 118, 0.2); }
.equipped-badge { position: absolute; top: 2px; left: 2px; background: #00e676; color: black; font-size: 6px; padding: 2px; font-weight: bold; }

/* --- MINIGAME --- */
.card-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 0 auto; width: fit-content; }
.card { width: 60px; height: 80px; perspective: 1000px; cursor: pointer; }
.card-inner { width: 100%; height: 100%; position: relative; transition: transform 0.6s; transform-style: preserve-3d; }
.card.flipped .card-inner { transform: rotateY(180deg); }
.card-front { background: #6a1b9a; position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; font-size: 20px; border: 2px solid white; }
.card-back { background: #fff; color: black; position: absolute; width: 100%; height: 100%; backface-visibility: hidden; transform: rotateY(180deg); display: flex; align-items: center; justify-content: center; font-size: 20px; border: 2px solid white; }

/* --- ARCADE NEW --- */
.arcade-panel { width: 60px; min-height: 400px; display: flex; flex-direction: column; align-items: center; }
.arcade-menu {background: #130b0b;height: 140px; ;display: flex; gap: 25px; margin-top: 60px; border: 2px solid rgb(207, 129, 100); }
.game-card-btn { margin-top: 15px;width: 135px; height: 110px; background: #212121; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px; font-size: 10px; transition: 0.2s; border: 2px solid #555; }
.game-card-btn:hover { background: #424242; transform: scale(1.1); border-color: gold; }
.game-stage { width: 100%; display: flex; flex-direction: column; align-items: center; }
.game-header { width: 100%; display: flex; justify-content: space-between; margin-bottom: 20px; border-bottom: 2px dashed #555; padding-bottom: 10px; }
.bet-controls { margin-top: 20px; display: flex; gap: 10px; align-items: center; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px; }
.bet-controls.vertical { flex-direction: column; }
.bet-controls input { width: 80px; padding: 5px; font-family: inherit; text-align: center; }
.game-msg { margin-top: 15px; font-size: 14px; color: gold; text-shadow: 2px 2px 0 #000; height: 20px; font-weight: bold; }

/* --- SLOT MACHINE --- */
.slot-machine-container { display: flex; flex-direction: column; align-items: center; }
.slot-bg { width: 250px; height: 180px; background-size: contain; background-repeat: no-repeat; background-position: center; position: relative; image-rendering: pixelated; }
.reels-window { position: absolute; top: 55px; left: 45px; width: 130px; height: 60px; display: flex; justify-content: space-around; align-items: center; background: #000; overflow: hidden; border: 2px inset #555; }
.reel { width: 40px; height: 40px; background: white; display: flex; align-items: center; justify-content: center; }
.reel img { width: 100%; height: 100%; object-fit: contain; }
.reel.blur img { filter: blur(2px); transform: translateY(-5px); transition: 0.1s; }
.btn-spin { background: #e53935; color: white; border: 2px solid white; font-size: 14px; padding: 5px 15px; box-shadow: 0 4px 0 #b71c1c; }
.btn-spin:active { transform: translateY(4px); box-shadow: 0 0 0; }
.btn-spin.disabled { filter: grayscale(1); pointer-events: none; }

/* --- COIN FLIP --- */
.coin-flip-container { display: flex; flex-direction: column; align-items: center; margin-top: 20px; }
.coin { width: 100px; height: 100px; position: relative; transform-style: preserve-3d; transition: transform 0.5s ease-out; }
.coin.heads { transform: rotateY(0deg); }
.coin.tails { transform: rotateY(180deg); }
.coin.flipping { animation: spinCoin 0.3s infinite linear; }
.side { position: absolute; width: 100%; height: 100%; border-radius: 50%; backface-visibility: hidden; border: 4px solid #fff; box-shadow: inset 0 0 10px rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; color: #3e2723; }
.side.heads { background: gold; }
.side.heads::after { content: 'HEADS'; }
.side.tails { background: silver; transform: rotateY(180deg); }
.side.tails::after { content: 'TAILS'; }
@keyframes spinCoin { 0% { transform: rotateY(0deg); } 100% { transform: rotateY(360deg); } }

/* --- CATS ON SCREEN (FIXED) --- */
.cat-wrapper { 
    position: absolute; 
    width: 32px; height: 32px; /* Container kích thước chuẩn */
    transition: left 0.5s linear; 
    cursor: pointer; z-index: 50; 
}
:root{
  --pixel-size: 10px;
}
/* QUAN TRỌNG: Cắt phần thừa của Spritesheet */
.Character { 
    width: 32px; height: 32px; 
    overflow: hidden; /* Dòng này sửa lỗi hiện nguyên bầy mèo */
    position: relative;
    transform: scale(4.5); 
    transform-origin: bottom center; /* Scale từ chân mèo */
    image-rendering: pixelated; /* Giữ ảnh pixel sắc nét khi phóng to */
}

.Character_spritesheet { 
    width: 128px; /* Kích thước gốc của file ảnh */
    display: block; 
    position: absolute; /* Để di chuyển ảnh bên trong khung */
    top: 0; left: 0;
}

/* Animation */
.is-moving .Character_spritesheet { animation: moveSpritesheet 0.8s steps(4) infinite; }
.is-idle .Character_spritesheet { animation: none; margin-left: 0; }

/* Các hướng nhìn - Sử dụng margin hoặc transform để dịch chuyển ảnh */
.face-right .Character_spritesheet { top: -32px; }
.face-left .Character_spritesheet { top: -96px; }

@keyframes moveSpritesheet { 
    from { transform: translateX(0px); } 
    to { transform: translateX(-128px); } 
}
/*hieu ung rare cho meo*/
.cat-sr {
  filter: drop-shadow(0 0 4px rgba(0, 255, 255, 0.8))
          drop-shadow(0 0 8px rgba(0, 255, 255, 0.4));
}
.cat-ssr {
  position: relative;
  filter: drop-shadow(0 0 6px gold)
          drop-shadow(0 0 14px rgba(255, 215, 0, 0.8));
}

.cat-ssr::after {
  content: '';
  position: absolute;
  inset: -4px;
  background: linear-gradient(
    120deg,
    transparent 30%,
    rgba(255,255,255,0.6),
    transparent 70%
  );
  animation: shimmer 2.5s infinite;
  pointer-events: none;
}

@keyframes shimmer {
  0%   { transform: translateX(-100%); }
  50%  { transform: translateX(100%); }
  100% { transform: translateX(100%); }
}
/* Bubble Popup */
.cat-think-panel { position: absolute; bottom: 100px; left: 30px; background: white; border: 2px solid black; color: black; padding: 5px; width: 130px; display: flex; flex-direction: column; gap: 2px; border-radius: 5px;  }
.cat-think-panel button {background-position-x: 10px; background: #123788; color: rgb(255, 255, 255); border: none; font-size: 10px; padding: 6px; text-align: left; margin: 3px; }
/* --- SETTINGS POPUP --- */
.setting-btn {
    font-size: 14px !important;
    background: #424242;
    border: 2px solid #aaa;
    width: 40px !important; min-width: unset;
}
.setting-btn:hover { background: #616161; }

.settings-panel {
    width: 300px;
    display: flex; flex-direction: column; gap: 20px;
}
.setting-row {
    display: flex; flex-direction: column; gap: 5px; text-align: left;
}
.setting-row label { color: gold; font-size: 12px; }
.setting-row input[type=range] {
    width: 100%; cursor: pointer;
}
/* --- SETTINGS POPUP --- */
.setting-btn {
    font-size: 14px !important;
    background: #424242;
    border: 2px solid #aaa;
    width: 40px !important; min-width: unset;
}
.setting-btn:hover { background: #616161; }

.settings-panel {
    width: 300px;
    display: flex; flex-direction: column; gap: 20px;
}
.setting-row {
    display: flex; flex-direction: column; gap: 5px; text-align: left;
}
.setting-row label { color: gold; font-size: 12px; }
.setting-row input[type=range] {
    width: 100%; cursor: pointer;
}